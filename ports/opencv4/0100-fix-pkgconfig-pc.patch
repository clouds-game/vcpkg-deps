--- a/cmake/OpenCVGenPkgconfig.cmake
+++ b/cmake/OpenCVGenPkgconfig.cmake
@@ -1,4 +1,4 @@
-if(MSVC OR IOS OR XROS)
+if(IOS OR XROS)
   return()
 endif()
 
@@ -103,7 +103,7 @@ add_custom_target(gen-pkgconfig ALL SOURCES "${CMAKE_BINARY_DIR}/unix-install/${
 add_dependencies(developer_scripts gen-pkgconfig)
 
 
-if((UNIX AND NOT ANDROID) OR MINGW)
+if((UNIX AND NOT ANDROID) OR MINGW OR MSVC)
   install(FILES ${CMAKE_BINARY_DIR}/unix-install/${OPENCV_PC_FILE_NAME} DESTINATION ${OPENCV_LIB_INSTALL_PATH}/pkgconfig COMPONENT dev)
 endif()
 
diff --git a/cmake/OpenCVUtils.cmake b/cmake/OpenCVUtils.cmake
index 23763cc..c13e873 100644
--- a/cmake/OpenCVUtils.cmake
+++ b/cmake/OpenCVUtils.cmake
@@ -1699,6 +1699,8 @@ macro(ocv_get_libname var_name)
   string(REGEX REPLACE "^lib(.+)\\.(a|so|dll)(\\.[.0-9]+)?$" "\\1" __libname "${__libname}")
   # MacOSX: libopencv_core.3.3.1.dylib -> opencv_core
   string(REGEX REPLACE "^lib(.+[^.0-9])\\.([.0-9]+\\.)?dylib$" "\\1" __libname "${__libname}")
+  # Windows: opencv_core.dll -> opencv_core
+  string(REGEX REPLACE "^(.+)\\.([.0-9]+\\.)?dll$" "\\1" __libname "${__libname}")
   set(${var_name} "${__libname}")
 endmacro()
 
